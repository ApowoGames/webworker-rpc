!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.webworkerRPC=r():e.webworkerRPC=r()}(this,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=20)}([function(e,r,t){var n,o,i;o=[t(4)],void 0===(i="function"==typeof(n=function(e){"use strict";var r,t,n,o=e.Reader,i=e.Writer,a=e.util,s=e.roots.default||(e.roots.default={});return s.webworker_rpc=((n={}).MSG_ERR=(r={},(t=Object.create(r))[r[0]="OK"]=0,t),n.Executor=function(){function r(e){if(this.params=[],e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.method="",r.prototype.context="",r.prototype.params=a.emptyArray,r.create=function(e){return new r(e)},r.encode=function(e,r){if(r||(r=i.create()),r.uint32(10).string(e.method),null!=e.context&&Object.hasOwnProperty.call(e,"context")&&r.uint32(18).string(e.context),null!=e.params&&e.params.length)for(var t=0;t<e.params.length;++t)s.webworker_rpc.Param.encode(e.params[t],r.uint32(26).fork()).ldelim();return r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.Executor;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.method=e.string();break;case 2:n.context=e.string();break;case 3:n.params&&n.params.length||(n.params=[]),n.params.push(s.webworker_rpc.Param.decode(e,e.uint32()));break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("method"))throw a.ProtocolError("missing required 'method'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isString(e.method))return"method: string expected";if(null!=e.context&&e.hasOwnProperty("context")&&!a.isString(e.context))return"context: string expected";if(null!=e.params&&e.hasOwnProperty("params")){if(!Array.isArray(e.params))return"params: array expected";for(var r=0;r<e.params.length;++r){var t=s.webworker_rpc.Param.verify(e.params[r]);if(t)return"params."+t}}return null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.Executor)return e;var r=new s.webworker_rpc.Executor;if(null!=e.method&&(r.method=String(e.method)),null!=e.context&&(r.context=String(e.context)),e.params){if(!Array.isArray(e.params))throw TypeError(".webworker_rpc.Executor.params: array expected");r.params=[];for(var t=0;t<e.params.length;++t){if("object"!=typeof e.params[t])throw TypeError(".webworker_rpc.Executor.params: object expected");r.params[t]=s.webworker_rpc.Param.fromObject(e.params[t])}}return r},r.toObject=function(e,r){r||(r={});var t={};if((r.arrays||r.defaults)&&(t.params=[]),r.defaults&&(t.method="",t.context=""),null!=e.method&&e.hasOwnProperty("method")&&(t.method=e.method),null!=e.context&&e.hasOwnProperty("context")&&(t.context=e.context),e.params&&e.params.length){t.params=[];for(var n=0;n<e.params.length;++n)t.params[n]=s.webworker_rpc.Param.toObject(e.params[n],r)}return t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.Param=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}var t;return r.prototype.t=1,r.prototype.valStr="",r.prototype.valBool=!1,r.prototype.valNum=0,r.prototype.valBytes=a.newBuffer([]),r.prototype.valExecutor=null,r.prototype.className="",Object.defineProperty(r.prototype,"val",{get:a.oneOfGetter(t=["valStr","valBool","valNum","valBytes","valExecutor"]),set:a.oneOfSetter(t)}),r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(8).int32(e.t),null!=e.valStr&&Object.hasOwnProperty.call(e,"valStr")&&r.uint32(18).string(e.valStr),null!=e.valBool&&Object.hasOwnProperty.call(e,"valBool")&&r.uint32(24).bool(e.valBool),null!=e.valNum&&Object.hasOwnProperty.call(e,"valNum")&&r.uint32(32).int32(e.valNum),null!=e.valBytes&&Object.hasOwnProperty.call(e,"valBytes")&&r.uint32(42).bytes(e.valBytes),null!=e.valExecutor&&Object.hasOwnProperty.call(e,"valExecutor")&&s.webworker_rpc.Executor.encode(e.valExecutor,r.uint32(50).fork()).ldelim(),null!=e.className&&Object.hasOwnProperty.call(e,"className")&&r.uint32(58).string(e.className),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.Param;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.t=e.int32();break;case 2:n.valStr=e.string();break;case 3:n.valBool=e.bool();break;case 4:n.valNum=e.int32();break;case 5:n.valBytes=e.bytes();break;case 6:n.valExecutor=s.webworker_rpc.Executor.decode(e,e.uint32());break;case 7:n.className=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("t"))throw a.ProtocolError("missing required 't'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var r={};switch(e.t){default:return"t: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.valStr&&e.hasOwnProperty("valStr")&&(r.val=1,!a.isString(e.valStr)))return"valStr: string expected";if(null!=e.valBool&&e.hasOwnProperty("valBool")){if(1===r.val)return"val: multiple values";if(r.val=1,"boolean"!=typeof e.valBool)return"valBool: boolean expected"}if(null!=e.valNum&&e.hasOwnProperty("valNum")){if(1===r.val)return"val: multiple values";if(r.val=1,!a.isInteger(e.valNum))return"valNum: integer expected"}if(null!=e.valBytes&&e.hasOwnProperty("valBytes")){if(1===r.val)return"val: multiple values";if(r.val=1,!(e.valBytes&&"number"==typeof e.valBytes.length||a.isString(e.valBytes)))return"valBytes: buffer expected"}if(null!=e.valExecutor&&e.hasOwnProperty("valExecutor")){if(1===r.val)return"val: multiple values";r.val=1;var t=s.webworker_rpc.Executor.verify(e.valExecutor);if(t)return"valExecutor."+t}return null!=e.className&&e.hasOwnProperty("className")&&!a.isString(e.className)?"className: string expected":null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.Param)return e;var r=new s.webworker_rpc.Param;switch(e.t){case"str":case 1:r.t=1;break;case"boolean":case 2:r.t=2;break;case"num":case 3:r.t=3;break;case"unit8array":case 4:r.t=4;break;case"executor":case 5:r.t=5;break;case"custom":case 6:r.t=6}if(null!=e.valStr&&(r.valStr=String(e.valStr)),null!=e.valBool&&(r.valBool=Boolean(e.valBool)),null!=e.valNum&&(r.valNum=0|e.valNum),null!=e.valBytes&&("string"==typeof e.valBytes?a.base64.decode(e.valBytes,r.valBytes=a.newBuffer(a.base64.length(e.valBytes)),0):e.valBytes.length&&(r.valBytes=e.valBytes)),null!=e.valExecutor){if("object"!=typeof e.valExecutor)throw TypeError(".webworker_rpc.Param.valExecutor: object expected");r.valExecutor=s.webworker_rpc.Executor.fromObject(e.valExecutor)}return null!=e.className&&(r.className=String(e.className)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.t=r.enums===String?"str":1,t.className=""),null!=e.t&&e.hasOwnProperty("t")&&(t.t=r.enums===String?s.webworker_rpc.ParamType[e.t]:e.t),null!=e.valStr&&e.hasOwnProperty("valStr")&&(t.valStr=e.valStr,r.oneofs&&(t.val="valStr")),null!=e.valBool&&e.hasOwnProperty("valBool")&&(t.valBool=e.valBool,r.oneofs&&(t.val="valBool")),null!=e.valNum&&e.hasOwnProperty("valNum")&&(t.valNum=e.valNum,r.oneofs&&(t.val="valNum")),null!=e.valBytes&&e.hasOwnProperty("valBytes")&&(t.valBytes=r.bytes===String?a.base64.encode(e.valBytes,0,e.valBytes.length):r.bytes===Array?Array.prototype.slice.call(e.valBytes):e.valBytes,r.oneofs&&(t.val="valBytes")),null!=e.valExecutor&&e.hasOwnProperty("valExecutor")&&(t.valExecutor=s.webworker_rpc.Executor.toObject(e.valExecutor,r),r.oneofs&&(t.val="valExecutor")),null!=e.className&&e.hasOwnProperty("className")&&(t.className=e.className),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.ParamType=function(){var e={},r=Object.create(e);return r[e[1]="str"]=1,r[e[2]="boolean"]=2,r[e[3]="num"]=3,r[e[4]="unit8array"]=4,r[e[5]="executor"]=5,r[e[6]="custom"]=6,r}(),n.Header=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.serviceName="",r.prototype.remoteExecutor=null,r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(10).string(e.serviceName),s.webworker_rpc.Executor.encode(e.remoteExecutor,r.uint32(18).fork()).ldelim(),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.Header;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.serviceName=e.string();break;case 2:n.remoteExecutor=s.webworker_rpc.Executor.decode(e,e.uint32());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("serviceName"))throw a.ProtocolError("missing required 'serviceName'",{instance:n});if(!n.hasOwnProperty("remoteExecutor"))throw a.ProtocolError("missing required 'remoteExecutor'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isString(e.serviceName))return"serviceName: string expected";var r=s.webworker_rpc.Executor.verify(e.remoteExecutor);return r?"remoteExecutor."+r:null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.Header)return e;var r=new s.webworker_rpc.Header;if(null!=e.serviceName&&(r.serviceName=String(e.serviceName)),null!=e.remoteExecutor){if("object"!=typeof e.remoteExecutor)throw TypeError(".webworker_rpc.Header.remoteExecutor: object expected");r.remoteExecutor=s.webworker_rpc.Executor.fromObject(e.remoteExecutor)}return r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.serviceName="",t.remoteExecutor=null),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),null!=e.remoteExecutor&&e.hasOwnProperty("remoteExecutor")&&(t.remoteExecutor=s.webworker_rpc.Executor.toObject(e.remoteExecutor,r)),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.ExecutePacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.id=0,r.prototype.header=null,r.prototype.bodyLen=0,r.prototype.body=a.newBuffer([]),r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(8).int32(e.id),s.webworker_rpc.Header.encode(e.header,r.uint32(18).fork()).ldelim(),null!=e.bodyLen&&Object.hasOwnProperty.call(e,"bodyLen")&&r.uint32(24).int32(e.bodyLen),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&r.uint32(34).bytes(e.body),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.ExecutePacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.int32();break;case 2:n.header=s.webworker_rpc.Header.decode(e,e.uint32());break;case 3:n.bodyLen=e.int32();break;case 4:n.body=e.bytes();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("id"))throw a.ProtocolError("missing required 'id'",{instance:n});if(!n.hasOwnProperty("header"))throw a.ProtocolError("missing required 'header'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isInteger(e.id))return"id: integer expected";var r=s.webworker_rpc.Header.verify(e.header);return r?"header."+r:null!=e.bodyLen&&e.hasOwnProperty("bodyLen")&&!a.isInteger(e.bodyLen)?"bodyLen: integer expected":null!=e.body&&e.hasOwnProperty("body")&&!(e.body&&"number"==typeof e.body.length||a.isString(e.body))?"body: buffer expected":null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.ExecutePacket)return e;var r=new s.webworker_rpc.ExecutePacket;if(null!=e.id&&(r.id=0|e.id),null!=e.header){if("object"!=typeof e.header)throw TypeError(".webworker_rpc.ExecutePacket.header: object expected");r.header=s.webworker_rpc.Header.fromObject(e.header)}return null!=e.bodyLen&&(r.bodyLen=0|e.bodyLen),null!=e.body&&("string"==typeof e.body?a.base64.decode(e.body,r.body=a.newBuffer(a.base64.length(e.body)),0):e.body.length&&(r.body=e.body)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.id=0,t.header=null,t.bodyLen=0,r.bytes===String?t.body="":(t.body=[],r.bytes!==Array&&(t.body=a.newBuffer(t.body)))),null!=e.id&&e.hasOwnProperty("id")&&(t.id=e.id),null!=e.header&&e.hasOwnProperty("header")&&(t.header=s.webworker_rpc.Header.toObject(e.header,r)),null!=e.bodyLen&&e.hasOwnProperty("bodyLen")&&(t.bodyLen=e.bodyLen),null!=e.body&&e.hasOwnProperty("body")&&(t.body=r.bytes===String?a.base64.encode(e.body,0,e.body.length):r.bytes===Array?Array.prototype.slice.call(e.body):e.body),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.ResponsePacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.id=0,r.prototype.val=null,r.prototype.err="",r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(8).int32(e.id),null!=e.val&&Object.hasOwnProperty.call(e,"val")&&s.webworker_rpc.Param.encode(e.val,r.uint32(18).fork()).ldelim(),null!=e.err&&Object.hasOwnProperty.call(e,"err")&&r.uint32(26).string(e.err),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.ResponsePacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.int32();break;case 2:n.val=s.webworker_rpc.Param.decode(e,e.uint32());break;case 3:n.err=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("id"))throw a.ProtocolError("missing required 'id'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isInteger(e.id))return"id: integer expected";if(null!=e.val&&e.hasOwnProperty("val")){var r=s.webworker_rpc.Param.verify(e.val);if(r)return"val."+r}return null!=e.err&&e.hasOwnProperty("err")&&!a.isString(e.err)?"err: string expected":null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.ResponsePacket)return e;var r=new s.webworker_rpc.ResponsePacket;if(null!=e.id&&(r.id=0|e.id),null!=e.val){if("object"!=typeof e.val)throw TypeError(".webworker_rpc.ResponsePacket.val: object expected");r.val=s.webworker_rpc.Param.fromObject(e.val)}return null!=e.err&&(r.err=String(e.err)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.id=0,t.val=null,t.err=""),null!=e.id&&e.hasOwnProperty("id")&&(t.id=e.id),null!=e.val&&e.hasOwnProperty("val")&&(t.val=s.webworker_rpc.Param.toObject(e.val,r)),null!=e.err&&e.hasOwnProperty("err")&&(t.err=e.err),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.AddRegistryPacket=function(){function r(e){if(this.executors=[],e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.id=0,r.prototype.serviceName="",r.prototype.executors=a.emptyArray,r.create=function(e){return new r(e)},r.encode=function(e,r){if(r||(r=i.create()),r.uint32(8).int32(e.id),r.uint32(18).string(e.serviceName),null!=e.executors&&e.executors.length)for(var t=0;t<e.executors.length;++t)s.webworker_rpc.Executor.encode(e.executors[t],r.uint32(26).fork()).ldelim();return r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.AddRegistryPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.int32();break;case 2:n.serviceName=e.string();break;case 3:n.executors&&n.executors.length||(n.executors=[]),n.executors.push(s.webworker_rpc.Executor.decode(e,e.uint32()));break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("id"))throw a.ProtocolError("missing required 'id'",{instance:n});if(!n.hasOwnProperty("serviceName"))throw a.ProtocolError("missing required 'serviceName'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isInteger(e.id))return"id: integer expected";if(!a.isString(e.serviceName))return"serviceName: string expected";if(null!=e.executors&&e.hasOwnProperty("executors")){if(!Array.isArray(e.executors))return"executors: array expected";for(var r=0;r<e.executors.length;++r){var t=s.webworker_rpc.Executor.verify(e.executors[r]);if(t)return"executors."+t}}return null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.AddRegistryPacket)return e;var r=new s.webworker_rpc.AddRegistryPacket;if(null!=e.id&&(r.id=0|e.id),null!=e.serviceName&&(r.serviceName=String(e.serviceName)),e.executors){if(!Array.isArray(e.executors))throw TypeError(".webworker_rpc.AddRegistryPacket.executors: array expected");r.executors=[];for(var t=0;t<e.executors.length;++t){if("object"!=typeof e.executors[t])throw TypeError(".webworker_rpc.AddRegistryPacket.executors: object expected");r.executors[t]=s.webworker_rpc.Executor.fromObject(e.executors[t])}}return r},r.toObject=function(e,r){r||(r={});var t={};if((r.arrays||r.defaults)&&(t.executors=[]),r.defaults&&(t.id=0,t.serviceName=""),null!=e.id&&e.hasOwnProperty("id")&&(t.id=e.id),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),e.executors&&e.executors.length){t.executors=[];for(var n=0;n<e.executors.length;++n)t.executors[n]=s.webworker_rpc.Executor.toObject(e.executors[n],r)}return t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.GotRegistryPacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.id=0,r.prototype.serviceName="",r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(8).int32(e.id),r.uint32(18).string(e.serviceName),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.GotRegistryPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.int32();break;case 2:n.serviceName=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("id"))throw a.ProtocolError("missing required 'id'",{instance:n});if(!n.hasOwnProperty("serviceName"))throw a.ProtocolError("missing required 'serviceName'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":a.isInteger(e.id)?a.isString(e.serviceName)?null:"serviceName: string expected":"id: integer expected"},r.fromObject=function(e){if(e instanceof s.webworker_rpc.GotRegistryPacket)return e;var r=new s.webworker_rpc.GotRegistryPacket;return null!=e.id&&(r.id=0|e.id),null!=e.serviceName&&(r.serviceName=String(e.serviceName)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.id=0,t.serviceName=""),null!=e.id&&e.hasOwnProperty("id")&&(t.id=e.id),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.UnlinkPacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.serviceName="",r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(10).string(e.serviceName),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.UnlinkPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.serviceName=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("serviceName"))throw a.ProtocolError("missing required 'serviceName'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":a.isString(e.serviceName)?null:"serviceName: string expected"},r.fromObject=function(e){if(e instanceof s.webworker_rpc.UnlinkPacket)return e;var r=new s.webworker_rpc.UnlinkPacket;return null!=e.serviceName&&(r.serviceName=String(e.serviceName)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.serviceName=""),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.RequestLinkPacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.serviceName="",r.prototype.workerName="",r.prototype.workerUrl="",r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(10).string(e.serviceName),r.uint32(18).string(e.workerName),r.uint32(26).string(e.workerUrl),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.RequestLinkPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.serviceName=e.string();break;case 2:n.workerName=e.string();break;case 3:n.workerUrl=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("serviceName"))throw a.ProtocolError("missing required 'serviceName'",{instance:n});if(!n.hasOwnProperty("workerName"))throw a.ProtocolError("missing required 'workerName'",{instance:n});if(!n.hasOwnProperty("workerUrl"))throw a.ProtocolError("missing required 'workerUrl'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":a.isString(e.serviceName)?a.isString(e.workerName)?a.isString(e.workerUrl)?null:"workerUrl: string expected":"workerName: string expected":"serviceName: string expected"},r.fromObject=function(e){if(e instanceof s.webworker_rpc.RequestLinkPacket)return e;var r=new s.webworker_rpc.RequestLinkPacket;return null!=e.serviceName&&(r.serviceName=String(e.serviceName)),null!=e.workerName&&(r.workerName=String(e.workerName)),null!=e.workerUrl&&(r.workerUrl=String(e.workerUrl)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.serviceName="",t.workerName="",t.workerUrl=""),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),null!=e.workerName&&e.hasOwnProperty("workerName")&&(t.workerName=e.workerName),null!=e.workerUrl&&e.hasOwnProperty("workerUrl")&&(t.workerUrl=e.workerUrl),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.DestroyManagerPacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.serviceName="",r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),null!=e.serviceName&&Object.hasOwnProperty.call(e,"serviceName")&&r.uint32(10).string(e.serviceName),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.DestroyManagerPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.serviceName=e.string();break;default:e.skipType(7&i)}}return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.serviceName&&e.hasOwnProperty("serviceName")&&!a.isString(e.serviceName)?"serviceName: string expected":null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.DestroyManagerPacket)return e;var r=new s.webworker_rpc.DestroyManagerPacket;return null!=e.serviceName&&(r.serviceName=String(e.serviceName)),r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.serviceName=""),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(t.serviceName=e.serviceName),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.LinkPacket=function(){function r(e){if(this.workers=[],e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.workers=a.emptyArray,r.create=function(e){return new r(e)},r.encode=function(e,r){if(r||(r=i.create()),null!=e.workers&&e.workers.length)for(var t=0;t<e.workers.length;++t)r.uint32(10).string(e.workers[t]);return r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.LinkPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.workers&&n.workers.length||(n.workers=[]),n.workers.push(e.string());break;default:e.skipType(7&i)}}return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.workers&&e.hasOwnProperty("workers")){if(!Array.isArray(e.workers))return"workers: array expected";for(var r=0;r<e.workers.length;++r)if(!a.isString(e.workers[r]))return"workers: string[] expected"}return null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.LinkPacket)return e;var r=new s.webworker_rpc.LinkPacket;if(e.workers){if(!Array.isArray(e.workers))throw TypeError(".webworker_rpc.LinkPacket.workers: array expected");r.workers=[];for(var t=0;t<e.workers.length;++t)r.workers[t]=String(e.workers[t])}return r},r.toObject=function(e,r){r||(r={});var t={};if((r.arrays||r.defaults)&&(t.workers=[]),e.workers&&e.workers.length){t.workers=[];for(var n=0;n<e.workers.length;++n)t.workers[n]=e.workers[n]}return t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.ProxyCreateWorkerPacket=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}return r.prototype.workerName="",r.prototype.workerUrl="",r.prototype.msg=null,r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(10).string(e.workerName),r.uint32(18).string(e.workerUrl),s.webworker_rpc.WebWorkerMessage.encode(e.msg,r.uint32(26).fork()).ldelim(),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.ProxyCreateWorkerPacket;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.workerName=e.string();break;case 2:n.workerUrl=e.string();break;case 3:n.msg=s.webworker_rpc.WebWorkerMessage.decode(e,e.uint32());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("workerName"))throw a.ProtocolError("missing required 'workerName'",{instance:n});if(!n.hasOwnProperty("workerUrl"))throw a.ProtocolError("missing required 'workerUrl'",{instance:n});if(!n.hasOwnProperty("msg"))throw a.ProtocolError("missing required 'msg'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!a.isString(e.workerName))return"workerName: string expected";if(!a.isString(e.workerUrl))return"workerUrl: string expected";var r=s.webworker_rpc.WebWorkerMessage.verify(e.msg);return r?"msg."+r:null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.ProxyCreateWorkerPacket)return e;var r=new s.webworker_rpc.ProxyCreateWorkerPacket;if(null!=e.workerName&&(r.workerName=String(e.workerName)),null!=e.workerUrl&&(r.workerUrl=String(e.workerUrl)),null!=e.msg){if("object"!=typeof e.msg)throw TypeError(".webworker_rpc.ProxyCreateWorkerPacket.msg: object expected");r.msg=s.webworker_rpc.WebWorkerMessage.fromObject(e.msg)}return r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.workerName="",t.workerUrl="",t.msg=null),null!=e.workerName&&e.hasOwnProperty("workerName")&&(t.workerName=e.workerName),null!=e.workerUrl&&e.hasOwnProperty("workerUrl")&&(t.workerUrl=e.workerUrl),null!=e.msg&&e.hasOwnProperty("msg")&&(t.msg=s.webworker_rpc.WebWorkerMessage.toObject(e.msg,r)),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n.WebWorkerMessage=function(){function r(e){if(e)for(var r=Object.keys(e),t=0;t<r.length;++t)null!=e[r[t]]&&(this[r[t]]=e[r[t]])}var t;return r.prototype.key="",r.prototype.dataLink=null,r.prototype.dataRequestLink=null,r.prototype.dataProxyCreateWorker=null,r.prototype.dataAddRegistry=null,r.prototype.dataGotRegistry=null,r.prototype.dataExecute=null,r.prototype.dataResponse=null,r.prototype.dataUnlink=null,r.prototype.dataDestroyManager=null,Object.defineProperty(r.prototype,"data",{get:a.oneOfGetter(t=["dataLink","dataRequestLink","dataProxyCreateWorker","dataAddRegistry","dataGotRegistry","dataExecute","dataResponse","dataUnlink","dataDestroyManager"]),set:a.oneOfSetter(t)}),r.create=function(e){return new r(e)},r.encode=function(e,r){return r||(r=i.create()),r.uint32(10).string(e.key),null!=e.dataLink&&Object.hasOwnProperty.call(e,"dataLink")&&s.webworker_rpc.LinkPacket.encode(e.dataLink,r.uint32(18).fork()).ldelim(),null!=e.dataRequestLink&&Object.hasOwnProperty.call(e,"dataRequestLink")&&s.webworker_rpc.RequestLinkPacket.encode(e.dataRequestLink,r.uint32(26).fork()).ldelim(),null!=e.dataProxyCreateWorker&&Object.hasOwnProperty.call(e,"dataProxyCreateWorker")&&s.webworker_rpc.ProxyCreateWorkerPacket.encode(e.dataProxyCreateWorker,r.uint32(34).fork()).ldelim(),null!=e.dataAddRegistry&&Object.hasOwnProperty.call(e,"dataAddRegistry")&&s.webworker_rpc.AddRegistryPacket.encode(e.dataAddRegistry,r.uint32(42).fork()).ldelim(),null!=e.dataGotRegistry&&Object.hasOwnProperty.call(e,"dataGotRegistry")&&s.webworker_rpc.GotRegistryPacket.encode(e.dataGotRegistry,r.uint32(50).fork()).ldelim(),null!=e.dataExecute&&Object.hasOwnProperty.call(e,"dataExecute")&&s.webworker_rpc.ExecutePacket.encode(e.dataExecute,r.uint32(58).fork()).ldelim(),null!=e.dataResponse&&Object.hasOwnProperty.call(e,"dataResponse")&&s.webworker_rpc.ResponsePacket.encode(e.dataResponse,r.uint32(66).fork()).ldelim(),null!=e.dataUnlink&&Object.hasOwnProperty.call(e,"dataUnlink")&&s.webworker_rpc.UnlinkPacket.encode(e.dataUnlink,r.uint32(74).fork()).ldelim(),null!=e.dataDestroyManager&&Object.hasOwnProperty.call(e,"dataDestroyManager")&&s.webworker_rpc.DestroyManagerPacket.encode(e.dataDestroyManager,r.uint32(82).fork()).ldelim(),r},r.encodeDelimited=function(e,r){return this.encode(e,r).ldelim()},r.decode=function(e,r){e instanceof o||(e=o.create(e));for(var t=void 0===r?e.len:e.pos+r,n=new s.webworker_rpc.WebWorkerMessage;e.pos<t;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.dataLink=s.webworker_rpc.LinkPacket.decode(e,e.uint32());break;case 3:n.dataRequestLink=s.webworker_rpc.RequestLinkPacket.decode(e,e.uint32());break;case 4:n.dataProxyCreateWorker=s.webworker_rpc.ProxyCreateWorkerPacket.decode(e,e.uint32());break;case 5:n.dataAddRegistry=s.webworker_rpc.AddRegistryPacket.decode(e,e.uint32());break;case 6:n.dataGotRegistry=s.webworker_rpc.GotRegistryPacket.decode(e,e.uint32());break;case 7:n.dataExecute=s.webworker_rpc.ExecutePacket.decode(e,e.uint32());break;case 8:n.dataResponse=s.webworker_rpc.ResponsePacket.decode(e,e.uint32());break;case 9:n.dataUnlink=s.webworker_rpc.UnlinkPacket.decode(e,e.uint32());break;case 10:n.dataDestroyManager=s.webworker_rpc.DestroyManagerPacket.decode(e,e.uint32());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("key"))throw a.ProtocolError("missing required 'key'",{instance:n});return n},r.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var r={};if(!a.isString(e.key))return"key: string expected";if(null!=e.dataLink&&e.hasOwnProperty("dataLink")&&(r.data=1,t=s.webworker_rpc.LinkPacket.verify(e.dataLink)))return"dataLink."+t;if(null!=e.dataRequestLink&&e.hasOwnProperty("dataRequestLink")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.RequestLinkPacket.verify(e.dataRequestLink))return"dataRequestLink."+t}if(null!=e.dataProxyCreateWorker&&e.hasOwnProperty("dataProxyCreateWorker")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.ProxyCreateWorkerPacket.verify(e.dataProxyCreateWorker))return"dataProxyCreateWorker."+t}if(null!=e.dataAddRegistry&&e.hasOwnProperty("dataAddRegistry")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.AddRegistryPacket.verify(e.dataAddRegistry))return"dataAddRegistry."+t}if(null!=e.dataGotRegistry&&e.hasOwnProperty("dataGotRegistry")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.GotRegistryPacket.verify(e.dataGotRegistry))return"dataGotRegistry."+t}if(null!=e.dataExecute&&e.hasOwnProperty("dataExecute")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.ExecutePacket.verify(e.dataExecute))return"dataExecute."+t}if(null!=e.dataResponse&&e.hasOwnProperty("dataResponse")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.ResponsePacket.verify(e.dataResponse))return"dataResponse."+t}if(null!=e.dataUnlink&&e.hasOwnProperty("dataUnlink")){if(1===r.data)return"data: multiple values";if(r.data=1,t=s.webworker_rpc.UnlinkPacket.verify(e.dataUnlink))return"dataUnlink."+t}if(null!=e.dataDestroyManager&&e.hasOwnProperty("dataDestroyManager")){if(1===r.data)return"data: multiple values";var t;if(r.data=1,t=s.webworker_rpc.DestroyManagerPacket.verify(e.dataDestroyManager))return"dataDestroyManager."+t}return null},r.fromObject=function(e){if(e instanceof s.webworker_rpc.WebWorkerMessage)return e;var r=new s.webworker_rpc.WebWorkerMessage;if(null!=e.key&&(r.key=String(e.key)),null!=e.dataLink){if("object"!=typeof e.dataLink)throw TypeError(".webworker_rpc.WebWorkerMessage.dataLink: object expected");r.dataLink=s.webworker_rpc.LinkPacket.fromObject(e.dataLink)}if(null!=e.dataRequestLink){if("object"!=typeof e.dataRequestLink)throw TypeError(".webworker_rpc.WebWorkerMessage.dataRequestLink: object expected");r.dataRequestLink=s.webworker_rpc.RequestLinkPacket.fromObject(e.dataRequestLink)}if(null!=e.dataProxyCreateWorker){if("object"!=typeof e.dataProxyCreateWorker)throw TypeError(".webworker_rpc.WebWorkerMessage.dataProxyCreateWorker: object expected");r.dataProxyCreateWorker=s.webworker_rpc.ProxyCreateWorkerPacket.fromObject(e.dataProxyCreateWorker)}if(null!=e.dataAddRegistry){if("object"!=typeof e.dataAddRegistry)throw TypeError(".webworker_rpc.WebWorkerMessage.dataAddRegistry: object expected");r.dataAddRegistry=s.webworker_rpc.AddRegistryPacket.fromObject(e.dataAddRegistry)}if(null!=e.dataGotRegistry){if("object"!=typeof e.dataGotRegistry)throw TypeError(".webworker_rpc.WebWorkerMessage.dataGotRegistry: object expected");r.dataGotRegistry=s.webworker_rpc.GotRegistryPacket.fromObject(e.dataGotRegistry)}if(null!=e.dataExecute){if("object"!=typeof e.dataExecute)throw TypeError(".webworker_rpc.WebWorkerMessage.dataExecute: object expected");r.dataExecute=s.webworker_rpc.ExecutePacket.fromObject(e.dataExecute)}if(null!=e.dataResponse){if("object"!=typeof e.dataResponse)throw TypeError(".webworker_rpc.WebWorkerMessage.dataResponse: object expected");r.dataResponse=s.webworker_rpc.ResponsePacket.fromObject(e.dataResponse)}if(null!=e.dataUnlink){if("object"!=typeof e.dataUnlink)throw TypeError(".webworker_rpc.WebWorkerMessage.dataUnlink: object expected");r.dataUnlink=s.webworker_rpc.UnlinkPacket.fromObject(e.dataUnlink)}if(null!=e.dataDestroyManager){if("object"!=typeof e.dataDestroyManager)throw TypeError(".webworker_rpc.WebWorkerMessage.dataDestroyManager: object expected");r.dataDestroyManager=s.webworker_rpc.DestroyManagerPacket.fromObject(e.dataDestroyManager)}return r},r.toObject=function(e,r){r||(r={});var t={};return r.defaults&&(t.key=""),null!=e.key&&e.hasOwnProperty("key")&&(t.key=e.key),null!=e.dataLink&&e.hasOwnProperty("dataLink")&&(t.dataLink=s.webworker_rpc.LinkPacket.toObject(e.dataLink,r),r.oneofs&&(t.data="dataLink")),null!=e.dataRequestLink&&e.hasOwnProperty("dataRequestLink")&&(t.dataRequestLink=s.webworker_rpc.RequestLinkPacket.toObject(e.dataRequestLink,r),r.oneofs&&(t.data="dataRequestLink")),null!=e.dataProxyCreateWorker&&e.hasOwnProperty("dataProxyCreateWorker")&&(t.dataProxyCreateWorker=s.webworker_rpc.ProxyCreateWorkerPacket.toObject(e.dataProxyCreateWorker,r),r.oneofs&&(t.data="dataProxyCreateWorker")),null!=e.dataAddRegistry&&e.hasOwnProperty("dataAddRegistry")&&(t.dataAddRegistry=s.webworker_rpc.AddRegistryPacket.toObject(e.dataAddRegistry,r),r.oneofs&&(t.data="dataAddRegistry")),null!=e.dataGotRegistry&&e.hasOwnProperty("dataGotRegistry")&&(t.dataGotRegistry=s.webworker_rpc.GotRegistryPacket.toObject(e.dataGotRegistry,r),r.oneofs&&(t.data="dataGotRegistry")),null!=e.dataExecute&&e.hasOwnProperty("dataExecute")&&(t.dataExecute=s.webworker_rpc.ExecutePacket.toObject(e.dataExecute,r),r.oneofs&&(t.data="dataExecute")),null!=e.dataResponse&&e.hasOwnProperty("dataResponse")&&(t.dataResponse=s.webworker_rpc.ResponsePacket.toObject(e.dataResponse,r),r.oneofs&&(t.data="dataResponse")),null!=e.dataUnlink&&e.hasOwnProperty("dataUnlink")&&(t.dataUnlink=s.webworker_rpc.UnlinkPacket.toObject(e.dataUnlink,r),r.oneofs&&(t.data="dataUnlink")),null!=e.dataDestroyManager&&e.hasOwnProperty("dataDestroyManager")&&(t.dataDestroyManager=s.webworker_rpc.DestroyManagerPacket.toObject(e.dataDestroyManager,r),r.oneofs&&(t.data="dataDestroyManager")),t},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),n),s})?n.apply(r,o):n)||(e.exports=i)},function(e,r,t){"use strict";(function(e){var n=r;function o(e,r,t){for(var n=Object.keys(r),o=0;o<n.length;++o)void 0!==e[n[o]]&&t||(e[n[o]]=r[n[o]]);return e}function i(e){function r(e,t){if(!(this instanceof r))return new r(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&o(this,t)}return(r.prototype=Object.create(Error.prototype)).constructor=r,Object.defineProperty(r.prototype,"name",{get:function(){return e}}),r.prototype.toString=function(){return this.name+": "+this.message},r}n.asPromise=t(7),n.base64=t(8),n.EventEmitter=t(9),n.float=t(10),n.inquire=t(11),n.utf8=t(12),n.pool=t(13),n.LongBits=t(14),n.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),n.global=n.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,r){var t=e[r];return!(null==t||!e.hasOwnProperty(r))&&("object"!=typeof t||(Array.isArray(t)?t.length:Object.keys(t).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,r){var t=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(t.lo,t.hi,r):t.toNumber(Boolean(r))},n.merge=o,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var r={},t=0;t<e.length;++t)r[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;t>-1;--t)if(1===r[e[t]]&&void 0!==this[e[t]]&&null!==this[e[t]])return e[t]}},n.oneOfSetter=function(e){return function(r){for(var t=0;t<e.length;++t)e[t]!==r&&delete this[e[t]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,t){return new e(r,t)},n._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}).call(this,t(6))},function(e,r,t){"use strict";e.exports=f;var n,o=t(1),i=o.LongBits,a=o.base64,s=o.utf8;function c(e,r,t){this.fn=e,this.len=r,this.next=void 0,this.val=t}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function f(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var p=function(){return o.Buffer?function(){return(f.create=function(){return new n})()}:function(){return new f}};function d(e,r,t){r[t]=255&e}function h(e,r){this.len=e,this.next=void 0,this.val=r}function w(e,r,t){for(;e.hi;)r[t++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)r[t++]=127&e.lo|128,e.lo=e.lo>>>7;r[t++]=e.lo}function y(e,r,t){r[t]=255&e,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24}f.create=p(),f.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(e,r,t){return this.tail=this.tail.next=new c(e,r,t),this.len+=r,this},h.prototype=Object.create(c.prototype),h.prototype.fn=function(e,r,t){for(;e>127;)r[t++]=127&e|128,e>>>=7;r[t]=e},f.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new h((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},f.prototype.int32=function(e){return e<0?this._push(w,10,i.fromNumber(e)):this.uint32(e)},f.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},f.prototype.uint64=function(e){var r=i.from(e);return this._push(w,r.length(),r)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(e){var r=i.from(e).zzEncode();return this._push(w,r.length(),r)},f.prototype.bool=function(e){return this._push(d,1,e?1:0)},f.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(e){var r=i.from(e);return this._push(y,4,r.lo)._push(y,4,r.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},f.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var k=o.Array.prototype.set?function(e,r,t){r.set(e,t)}:function(e,r,t){for(var n=0;n<e.length;++n)r[t+n]=e[n]};f.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(d,1,0);if(o.isString(e)){var t=f.alloc(r=a.length(e));a.decode(e,t,0),e=t}return this.uint32(r)._push(k,r,e)},f.prototype.string=function(e){var r=s.length(e);return r?this.uint32(r)._push(s.write,r,e):this._push(d,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},f.prototype.ldelim=function(){var e=this.head,r=this.tail,t=this.len;return this.reset().uint32(t),t&&(this.tail.next=e.next,this.tail=r,this.len+=t),this},f.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),t=0;e;)e.fn(e.val,r,t),t+=e.len,e=e.next;return r},f._configure=function(e){n=e,f.create=p(),n._configure()}},function(e,r,t){"use strict";e.exports=c;var n,o=t(1),i=o.LongBits,a=o.utf8;function s(e,r){return RangeError("index out of range: "+e.pos+" + "+(r||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},f=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function p(){var e=new i(0,0),r=0;if(!(this.len-this.pos>4)){for(;r<3;++r){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*r)>>>0,e}for(;r<4;++r)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(r=0,this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,r){return(e[r-4]|e[r-3]<<8|e[r-2]<<16|e[r-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw s(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),r=this.pos,t=this.pos+e;if(t>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,t):r===t?new this.buf.constructor(0):this._slice.call(this.buf,r,t)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=f(),n._configure();var r=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return p.call(this)[r](!1)},uint64:function(){return p.call(this)[r](!0)},sint64:function(){return p.call(this).zzDecode()[r](!1)},fixed64:function(){return h.call(this)[r](!0)},sfixed64:function(){return h.call(this)[r](!1)}})}},function(e,r,t){"use strict";e.exports=t(5)},function(e,r,t){"use strict";var n=r;function o(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=t(2),n.BufferWriter=t(15),n.Reader=t(3),n.BufferReader=t(16),n.util=t(1),n.rpc=t(17),n.roots=t(19),n.configure=o,o()},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r,t){"use strict";e.exports=function(e,r){var t=new Array(arguments.length-1),n=0,o=2,i=!0;for(;o<arguments.length;)t[n++]=arguments[o++];return new Promise((function(o,a){t[n]=function(e){if(i)if(i=!1,e)a(e);else{for(var r=new Array(arguments.length-1),t=0;t<r.length;)r[t++]=arguments[t];o.apply(null,r)}};try{e.apply(r||null,t)}catch(e){i&&(i=!1,a(e))}}))}},function(e,r,t){"use strict";var n=r;n.length=function(e){var r=e.length;if(!r)return 0;for(var t=0;--r%4>1&&"="===e.charAt(r);)++t;return Math.ceil(3*e.length)/4-t};for(var o=new Array(64),i=new Array(123),a=0;a<64;)i[o[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;n.encode=function(e,r,t){for(var n,i=null,a=[],s=0,c=0;r<t;){var u=e[r++];switch(c){case 0:a[s++]=o[u>>2],n=(3&u)<<4,c=1;break;case 1:a[s++]=o[n|u>>4],n=(15&u)<<2,c=2;break;case 2:a[s++]=o[n|u>>6],a[s++]=o[63&u],c=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=o[n],a[s++]=61,1===c&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};n.decode=function(e,r,t){for(var n,o=t,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(a){case 0:n=c,a=1;break;case 1:r[t++]=n<<2|(48&c)>>4,n=c,a=2;break;case 2:r[t++]=(15&n)<<4|(60&c)>>2,n=c,a=3;break;case 3:r[t++]=(3&n)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return t-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,r,t){"use strict";function n(){this._listeners={}}e.exports=n,n.prototype.on=function(e,r,t){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:t||this}),this},n.prototype.off=function(e,r){if(void 0===e)this._listeners={};else if(void 0===r)this._listeners[e]=[];else for(var t=this._listeners[e],n=0;n<t.length;)t[n].fn===r?t.splice(n,1):++n;return this},n.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,t)}return this}},function(e,r,t){"use strict";function n(e){return"undefined"!=typeof Float32Array?function(){var r=new Float32Array([-0]),t=new Uint8Array(r.buffer),n=128===t[3];function o(e,n,o){r[0]=e,n[o]=t[0],n[o+1]=t[1],n[o+2]=t[2],n[o+3]=t[3]}function i(e,n,o){r[0]=e,n[o]=t[3],n[o+1]=t[2],n[o+2]=t[1],n[o+3]=t[0]}function a(e,n){return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],r[0]}function s(e,n){return t[3]=e[n],t[2]=e[n+1],t[1]=e[n+2],t[0]=e[n+3],r[0]}e.writeFloatLE=n?o:i,e.writeFloatBE=n?i:o,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function r(e,r,t,n){var o=r<0?1:0;if(o&&(r=-r),0===r)e(1/r>0?0:2147483648,t,n);else if(isNaN(r))e(2143289344,t,n);else if(r>34028234663852886e22)e((o<<31|2139095040)>>>0,t,n);else if(r<11754943508222875e-54)e((o<<31|Math.round(r/1401298464324817e-60))>>>0,t,n);else{var i=Math.floor(Math.log(r)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(r*Math.pow(2,-i)*8388608))>>>0,t,n)}}function t(e,r,t){var n=e(r,t),o=2*(n>>31)+1,i=n>>>23&255,a=8388607&n;return 255===i?a?NaN:o*(1/0):0===i?1401298464324817e-60*o*a:o*Math.pow(2,i-150)*(a+8388608)}e.writeFloatLE=r.bind(null,o),e.writeFloatBE=r.bind(null,i),e.readFloatLE=t.bind(null,a),e.readFloatBE=t.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var r=new Float64Array([-0]),t=new Uint8Array(r.buffer),n=128===t[7];function o(e,n,o){r[0]=e,n[o]=t[0],n[o+1]=t[1],n[o+2]=t[2],n[o+3]=t[3],n[o+4]=t[4],n[o+5]=t[5],n[o+6]=t[6],n[o+7]=t[7]}function i(e,n,o){r[0]=e,n[o]=t[7],n[o+1]=t[6],n[o+2]=t[5],n[o+3]=t[4],n[o+4]=t[3],n[o+5]=t[2],n[o+6]=t[1],n[o+7]=t[0]}function a(e,n){return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t[4]=e[n+4],t[5]=e[n+5],t[6]=e[n+6],t[7]=e[n+7],r[0]}function s(e,n){return t[7]=e[n],t[6]=e[n+1],t[5]=e[n+2],t[4]=e[n+3],t[3]=e[n+4],t[2]=e[n+5],t[1]=e[n+6],t[0]=e[n+7],r[0]}e.writeDoubleLE=n?o:i,e.writeDoubleBE=n?i:o,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function r(e,r,t,n,o,i){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,o,i+r),e(1/n>0?0:2147483648,o,i+t);else if(isNaN(n))e(0,o,i+r),e(2146959360,o,i+t);else if(n>17976931348623157e292)e(0,o,i+r),e((a<<31|2146435072)>>>0,o,i+t);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,o,i+r),e((a<<31|s/4294967296)>>>0,o,i+t);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=n*Math.pow(2,-c))>>>0,o,i+r),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,o,i+t)}}}function t(e,r,t,n,o){var i=e(n,o+r),a=e(n,o+t),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+i;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=r.bind(null,o,0,4),e.writeDoubleBE=r.bind(null,i,4,0),e.readDoubleLE=t.bind(null,a,0,4),e.readDoubleBE=t.bind(null,s,4,0)}(),e}function o(e,r,t){r[t]=255&e,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24}function i(e,r,t){r[t]=e>>>24,r[t+1]=e>>>16&255,r[t+2]=e>>>8&255,r[t+3]=255&e}function a(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24)>>>0}function s(e,r){return(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3])>>>0}e.exports=n(n)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,r,t){"use strict";var n=r;n.length=function(e){for(var r=0,t=0,n=0;n<e.length;++n)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:55296==(64512&t)&&56320==(64512&e.charCodeAt(n+1))?(++n,r+=4):r+=3;return r},n.read=function(e,r,t){if(t-r<1)return"";for(var n,o=null,i=[],a=0;r<t;)(n=e[r++])<128?i[a++]=n:n>191&&n<224?i[a++]=(31&n)<<6|63&e[r++]:n>239&&n<365?(n=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,i[a++]=55296+(n>>10),i[a++]=56320+(1023&n)):i[a++]=(15&n)<<12|(63&e[r++])<<6|63&e[r++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,i.slice(0,a))),o.join("")):String.fromCharCode.apply(String,i.slice(0,a))},n.write=function(e,r,t){for(var n,o,i=t,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?r[t++]=n:n<2048?(r[t++]=n>>6|192,r[t++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&o),++a,r[t++]=n>>18|240,r[t++]=n>>12&63|128,r[t++]=n>>6&63|128,r[t++]=63&n|128):(r[t++]=n>>12|224,r[t++]=n>>6&63|128,r[t++]=63&n|128);return t-i}},function(e,r,t){"use strict";e.exports=function(e,r,t){var n=t||8192,o=n>>>1,i=null,a=n;return function(t){if(t<1||t>o)return e(t);a+t>n&&(i=e(n),a=0);var s=r.call(i,a,a+=t);return 7&a&&(a=1+(7|a)),s}}},function(e,r,t){"use strict";e.exports=o;var n=t(1);function o(e,r){this.lo=e>>>0,this.hi=r>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var a=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var r=e<0;r&&(e=-e);var t=e>>>0,n=(e-t)/4294967296>>>0;return r&&(n=~n>>>0,t=~t>>>0,++t>4294967295&&(t=0,++n>4294967295&&(n=0))),new o(t,n)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(n.isString(e)){if(!n.Long)return o.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=1+~this.lo>>>0,t=~this.hi>>>0;return r||(t=t+1>>>0),-(r+4294967296*t)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;o.fromHash=function(e){return e===a?i:new o((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,t=this.hi>>>24;return 0===t?0===r?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:t<128?9:10}},function(e,r,t){"use strict";e.exports=i;var n=t(2);(i.prototype=Object.create(n.prototype)).constructor=i;var o=t(1);function i(){n.call(this)}function a(e,r,t){e.length<40?o.utf8.write(e,r,t):r.utf8Write?r.utf8Write(e,t):r.write(e,t)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,r,t){r.set(e,t)}:function(e,r,t){if(e.copy)e.copy(r,t,0,e.length);else for(var n=0;n<e.length;)r[t++]=e[n++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(i.writeBytesBuffer,r,e),this},i.prototype.string=function(e){var r=o.Buffer.byteLength(e);return this.uint32(r),r&&this._push(a,r,e),this},i._configure()},function(e,r,t){"use strict";e.exports=i;var n=t(3);(i.prototype=Object.create(n.prototype)).constructor=i;var o=t(1);function i(e){n.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},function(e,r,t){"use strict";r.Service=t(18)},function(e,r,t){"use strict";e.exports=o;var n=t(1);function o(e,r,t){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(r),this.responseDelimited=Boolean(t)}(o.prototype=Object.create(n.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(r,t,o,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(e,s,r,t,o,i);if(s.rpcImpl)try{return s.rpcImpl(r,t[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,t){if(e)return s.emit("error",e,r),a(e);if(null!==t){if(!(t instanceof o))try{t=o[s.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return s.emit("error",e,r),a(e)}return s.emit("data",t,r),a(null,t)}s.end(!0)}))}catch(e){return s.emit("error",e,r),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,r,t){"use strict";e.exports={}},function(e,r,t){"use strict";t.r(r),t.d(r,"webworker_rpc",(function(){return n.webworker_rpc})),t.d(r,"RPCEmitter",(function(){return E})),t.d(r,"RPCPeer",(function(){return N})),t.d(r,"LinkListener",(function(){return R})),t.d(r,"Export",(function(){return m})),t.d(r,"RemoteListener",(function(){return _})),t.d(r,"RPCData",(function(){return s}));var n=t(0),o=function(){function e(){var e=this;this.resolver=null,this.rejecter=null,this.set=function(r,t){if(void 0===t&&(t=null),e.resolver){var n=new Error("Resolver already exists");if(t)return t(n);throw n}e.resolver=r,e.rejecter=t},this.promise=function(r){return new Promise((function(t,n){if(e.set(t,n),r)try{r()}catch(r){e.reject(r)}}))},this.resolve=function(r){if(!e.resolver){var t=new Error("No Resolver");if(e.rejecter)return e.rejecter(t);throw t}e.resolver(r),e.resolver=null,e.rejecter=null},this.reject=function(r){if(!e.rejecter)throw r;e.rejecter(r),e.resolver=null,e.rejecter=null}}return e.create=function(){return new e},e}(),i=function(){function e(e){this.data=new n.webworker_rpc.Param(e)}return e.createByValue=function(r){if(null==r)return new e({t:n.webworker_rpc.ParamType.custom,className:null===r?"null":"undefined"});if("string"==typeof r)return new e({t:n.webworker_rpc.ParamType.str,valStr:r});if("boolean"==typeof r)return new e({t:n.webworker_rpc.ParamType.boolean,valBool:r});if("number"==typeof r)return new e({t:n.webworker_rpc.ParamType.num,valNum:r});if(r.constructor===Uint8Array)return new e({t:n.webworker_rpc.ParamType.unit8array,valBytes:r});if(r instanceof n.webworker_rpc.Executor)return new e({t:n.webworker_rpc.ParamType.executor,valExecutor:r});var t=r.constructor.name;if(!a.has(t))return console.error(t+" not use @RPCData"),new e({t:n.webworker_rpc.ParamType.custom,className:"null"});var o=a.get(t).encode(r);return new e({t:n.webworker_rpc.ParamType.custom,valStr:o,className:t})},e.prototype.getValue=function(){switch(this.data.t){case n.webworker_rpc.ParamType.custom:if("null"===this.data.className)return null;if("undefined"===this.data.className)return;return a.has(this.data.className)?a.get(this.data.className).decode(this.data.valStr):(console.error(this.data.className+" not use @RPCData"),null);default:return this.data[this.data.val]}},e}(),a=new Map;function s(){return function(e){return e.encode||(e.encode=u.encode),e.decode||(e.decode=u.decode),a.set(e.name,e),e}}var c,u=function(){function e(){}return e.encode=function(e){return JSON.stringify(e)},e.decode=function(e){return JSON.parse(e)},e}(),l=function(e){if("undefined"!=typeof MessageChannel){var r=new Map,t=null,n=function(e,n){r.has(e)||(0===r.size&&(t=n),r.set(e,n),n.onmessage=function(e){var r=e.data.key;if(null!=r)switch(r){case"requestLink":o(e);break;case"unlink":i(e);break;case"destroyManager":a(e)}})},o=function(e){var o=e.data.dataRequestLink,i=o.serviceName,a=o.workerName,s=o.workerUrl,c=new MessageChannel;if(r.has(i))if(r.get(i).postMessage({key:"link",dataLink:{workers:[a]}},[c.port1]),r.has(a))r.get(a).postMessage({key:"link",dataLink:{workers:[i]}},[c.port2]);else{if(null==s)return void console.error("webworker-rpc: worker url undefined");var u=new MessageChannel;if(null==t)return;t.postMessage({key:"proxyCreateWorker",dataProxyCreateWorker:{workerName:a,workerUrl:s,msg:{key:"link",dataLink:{workers:["__MANAGER",i]}}}},[u.port2,c.port2]),n(a,u.port1)}else console.error("webworker-rpc: __MANAGER not yet link to "+i)},i=function(e){var t=e.data.dataUnlink.serviceName;r.has(t)&&r.delete(t)},a=function(e){e.data.dataDestroyManager.serviceName;for(var t=0,n=Array.from(r.keys());t<n.length;t++){var o=n[t];r.get(o).postMessage({key:"unlink",dataUnlink:{serviceName:"__MANAGER"}})}console.log("webworker-rpc: manager worker closed"),self.close()};switch(e.data.key){case"link":!function(e){for(var r=e.data.dataLink.workers,t=e.ports,o=0;o<t.length;o++){var i=t[o],a=r[o];n(a,i)}}(e)}}else console.error("webworker-rpc: MessageChannel undefined")},f=(c=function(e,r){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}c(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),p=function(e,r,t,n){var o,i=arguments.length,a=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(r,t,a):o(r,t))||a);return i>3&&a&&Object.defineProperty(r,t,a),a},d=function(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)},h=new Map,w=new Map,y=[],k=new Map,b=function(e,r,t,n){var o="function"==typeof e?e.name+".constructor":e.constructor.name,a=[];if(null!=n)for(var s=0,c=n;s<c.length;s++){var u=c[s];a.push(new i({t:u}).data)}v({method:r,context:o,params:a})},v=function(e){h.has(e.context)||h.set(e.context,[]);var r=h.get(e.context);return r.findIndex((function(r){return r.method===e.method}))<0&&(r.push(e),!0)};function m(e){return function(r,t,n){null!=n?b(r,t,0,e):null!=t?function(e,r){var t="function"==typeof e?e.name+".constructor":e.constructor.name;k.has(t)||k.set(t,[]),k.get(t).push(r)}(r,t):function(e){y.push(e.name)}(r)}}var g=new Map;function _(e,r,t,o){return function(a,s,c){b(a,s,0,o);var u="function"==typeof a?a.name+".constructor":a.constructor.name,l=[];if(null!=o)for(var f=0,p=o;f<p.length;f++){var d=p[f];l.push(new i({t:d}).data)}var h=null;h=l.length>0?new n.webworker_rpc.Executor({method:s,context:u,params:l}):new n.webworker_rpc.Executor({method:s,context:u}),g.has(e)||g.set(e,[]),g.get(e).push({context:r,event:t,executor:h})}}var x=["prototype","__proto__","self","worker","remote","getInstance","_instance"],P=["destroy"];function O(){return function(e,r,t){for(var n in e)x.includes(n)||x.push(n);for(var o=0,i=e.constructor;o<i.length;o++){n=i[o];x.includes(n)||x.push(n)}}}var E=function(){function e(){this.emitFunctions=new Map,w.set(this.constructor.name,this),this.checkSuperExport()}return e.prototype.on=function(e,r,t){this.emitFunctions.has(e)||this.emitFunctions.set(e,[]),this.emitFunctions.get(e).push({worker:t,executor:r})},e.prototype.off=function(e,r,t){if(this.emitFunctions.has(e))if(r&&t&&"string"==typeof t){var n=this.emitFunctions.get(e),o=n.findIndex((function(e){return e.worker===t&&e.executor===r}));o>0&&n.splice(o,0)}else this.emitFunctions.delete(e)},e.prototype.emit=function(e){for(var r,t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.emitFunctions.has(e))if(N.getInstance())for(var o=this.emitFunctions.get(e),i=0,a=o;i<a.length;i++){var s=a[i];s.worker in N.getInstance().remote&&(r=N.getInstance().remote[s.worker][s.executor.context])[s.executor.method].apply(r,t)}else console.error("webworker-rpc: no peer created")},e.prototype.checkSuperExport=function(){for(var e=this.constructor.name,r=e+".constructor",t=Object.getPrototypeOf(this),n=Object.getPrototypeOf(t).constructor.name,o=n+".constructor";"Object"!==n;){if(h.has(n)){for(var i=0,a=c=h.get(n);i<a.length;i++){a[i].context=e}h.delete(n);var s=h.get(e)||[];h.set(e,s.concat(c))}if(h.has(o)){for(var c,u=0,l=c=h.get(o);u<l.length;u++){l[u].context=r}h.delete(o);s=h.get(r)||[];h.set(r,s.concat(c))}if(k.has(n)){var f=k.get(n);k.delete(n);var p=k.get(e)||[];k.set(e,p.concat(f))}if(k.has(o)){f=k.get(o);k.delete(o);p=k.get(r)||[];k.set(r,p.concat(f))}var d=y.indexOf(n);d>=0&&(y.splice(d,1),y.push(e));var w=y.indexOf(o);w>=0&&(y.splice(w,1),y.push(r)),t=Object.getPrototypeOf(t),o=(n=Object.getPrototypeOf(t).constructor.name)+".constructor"}},p([m([n.webworker_rpc.ParamType.str,n.webworker_rpc.ParamType.executor,n.webworker_rpc.ParamType.str]),O(),d("design:type",Function),d("design:paramtypes",[String,Object,String]),d("design:returntype",void 0)],e.prototype,"on",null),p([m([n.webworker_rpc.ParamType.str]),d("design:type",Function),d("design:paramtypes",[String,Object,String]),d("design:returntype",void 0)],e.prototype,"off",null),e}(),N=function(e){function r(t){var o=e.call(this)||this;return o.MESSAGEKEY_LINK="link",o.MESSAGEKEY_REQUEST_LINK="requestLink",o.MESSAGEKEY_PROXY_CREATE_WORKER="proxyCreateWorker",o.MESSAGEKEY_ADD_REGISTRY="addRegistry",o.MESSAGEKEY_GOT_REGISTRY="gotRegistry",o.MESSAGEKEY_EXECUTE="execute",o.MESSAGEKEY_RESPOND="respond",o.MESSAGEKEY_UNLINK="unlink",o.MESSAGEKEY_DESTROY_MANAGER="destroyManager",o.exported=!1,"undefined"==typeof MessageChannel?(console.error("webworker-rpc: MessageChannel undefined"),o):("undefined"==typeof SharedArrayBuffer&&(console.warn("webworker-rpc: SharedArrayBuffer is undefined, use ArrayBuffer instead"),r.useSharedArrayBuffer=!1),null==t?(console.error("webworker-rpc: param [name] error"),o):r._instance?(console.error("webworker-rpc: duplicate RPCPeer created: "+t+" & "+r._instance.name),o):(r._instance=o,console.log("webworker-rpc: new peer: ",t),o.name=t,o.worker=self,o.registry=new Map,o.channels=new Map,o.linkListeners=new Map,o.linkTasks=[],o.resolvers=new Map,o.registryPackID=0,o.resolverID=0,o.syncRegistryListeners=new Map,o.worker.addEventListener("message",(function(e){var t,i=(t=r.useSharedArrayBuffer&&e.data instanceof SharedArrayBuffer||!r.useSharedArrayBuffer&&e.data instanceof ArrayBuffer?n.webworker_rpc.WebWorkerMessage.decode(new Uint8Array(e.data)):e.data).key;void 0!==i&&i===o.MESSAGEKEY_LINK&&o.onMessage_Link(t.dataLink,[].concat(e.ports))})),o))}return f(r,e),r.create=function(e){return r._instance=new r(e),r._instance},r.getInstance=function(){return r._instance},r.attach=function(e,t,n){return r._instance?r._instance.attach(e,t,n):(console.error("webworker-rpc: RPCPeer not created"),null)},Object.defineProperty(r,"remote",{get:function(){return r._instance?r._instance.remote:(console.error("webworker-rpc: RPCPeer not created"),null)},enumerable:!1,configurable:!0}),r.exportProperty=function(e,t,n){return r._instance?r._instance.exportProperty(e,t,n):(console.error("webworker-rpc: RPCPeer not created"),null)},r.destroy=function(){return r._instance?r._instance.destroy():(console.error("webworker-rpc: RPCPeer not created"),null)},r.destroyManagerWorker=function(){return r._instance?r._instance.destroyManagerWorker():(console.error("webworker-rpc: RPCPeer not created"),null)},r.prototype.attach=function(e,r,t){if(void 0===t&&(t=!1),this.linkListeners.has(e))return console.warn("webworker-rpc: already requested link to "+e),this.linkListeners.get(e);var o=new R(this.name,e);if(t){if(this.channels.has(e))return console.error("webworker-rpc: ONLY_ONE_WORKER mode, already linked "+e+"."),o;if(this.channels.size>0)return console.error("webworker-rpc: ONLY_ONE_WORKER mode cannot create another worker. ",this.channels),o;if("undefined"==typeof Worker)return console.error("webworker-rpc: "+this.name+" cannot create worker."),o;if(void 0===r||0===r.length)return console.error("webworker-rpc: ONLY_ONE_WORKER mode not support undefined workerUrl (besides windows)."),o;this.linkListeners.set(e,o);var i=new Worker(r),a=new MessageChannel,s=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_LINK,dataLink:new n.webworker_rpc.LinkPacket({workers:[this.name]})});this.send(s,i,!0,[a.port2]),this.addChannel(e,a.port1)}else{if(this.linkListeners.set(e,o),!this.channels.has("__MANAGER")){var c=this.worker.name;if(void 0!==c&&c===this.name)return this.linkTasks.push({workerName:e,workerUrl:r}),o;if("undefined"==typeof Worker)return void console.error("webworker-rpc: Worker undefined! can not create manager worker.");var u=this.getManagerWorkerURL(),l=new Worker(u),f=new MessageChannel;s=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_LINK,dataLink:new n.webworker_rpc.LinkPacket({workers:[this.name]})});this.send(s,l,!1,[f.port2]),this.addChannel("__MANAGER",f.port1)}var p=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_REQUEST_LINK,dataRequestLink:new n.webworker_rpc.RequestLinkPacket({serviceName:this.name,workerName:e,workerUrl:r})});this.send(p,"__MANAGER",!1)}return o},r.prototype.destroyManagerWorker=function(){if(this.channels.has("__MANAGER")){var e=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_DESTROY_MANAGER,dataDestroyManager:new n.webworker_rpc.DestroyManagerPacket({serviceName:this.name})});this.send(e,"__MANAGER",!1)}},r.prototype.destroy=function(){for(var e=0,t=Array.from(this.channels.keys());e<t.length;e++){var o=t[e];if(g.has(o))for(var i=0,a=g.get(o);i<a.length;i++){var s=a[i];this.remote[o][s.context].off(s.event,s.executor,this.name)}var c=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_UNLINK,dataUnlink:new n.webworker_rpc.UnlinkPacket({serviceName:this.name})});this.send(c,o,"__MANAGER"!==o)}void 0!==r._instance&&null!==r._instance&&(r._instance=null),console.log("webworker-rpc: "+this.name+" closed"),self.close()},r.prototype.exportProperty=function(e,r,t){if(null==t)for(var o in r){if(Object.prototype.hasOwnProperty.call(r,o))r[o]===e&&(t=o)}if(0!==t.length){r[t]!==e&&(void 0!==r[t]&&null!==r[t]&&console.warn("webworker-rpc: "+t+" exist, replaced"),r[t]=e);for(var i="",a=0,s=Array.from(w.keys());a<s.length;a++){var c=s[a];if(w.get(c)===r){i=c;break}}var u=i;if(0===i.length){if(u=r.constructor.name,w.has(u))return void console.error("webworker-rpc: context name <"+u+"> exist");w.set(u,r)}var l=this.exportObject(e,u+"."+t,!1),f=Array.from(this.channels.keys());this.registryPackID++;var p=new j(this.registryPackID,f);this.syncRegistryListeners.set(this.registryPackID,p);for(var d=0,h=f;d<h.length;d++){c=h[d];this.postRegistry(c,new n.webworker_rpc.AddRegistryPacket({id:this.registryPackID,serviceName:this.name,executors:l}))}return p}console.error("webworker-rpc: "+e+" is not in "+r)},r.prototype.onWorkerUnlinked=function(e){console.log("webworker-rpc: "+this.name+" onWorkerUnlinked: ",e)},r.prototype.send=function(e,t,o,i){var a=e,s=void 0===i?[]:i;if(o){var c=n.webworker_rpc.WebWorkerMessage.encode(e).finish();if(r.useSharedArrayBuffer){var u=new SharedArrayBuffer(c.byteLength);new Uint8Array(u).set(c,0),a=u}else{var l=c.buffer.slice(c.byteOffset,c.byteLength+c.byteOffset);a=l,s=s.concat(l)}}"string"==typeof t?this.channels.has(t)&&this.channels.get(t).postMessage(a,s):t.postMessage(a,s)},r.prototype.addChannel=function(e,t){var o=this;if(this.channels.has(e))this.registry.has(e)&&this.updateLinkState(e);else{this.channels.set(e,t),t.onmessage=function(e){var t,i=(t=r.useSharedArrayBuffer&&e.data instanceof SharedArrayBuffer||!r.useSharedArrayBuffer&&e.data instanceof ArrayBuffer?n.webworker_rpc.WebWorkerMessage.decode(new Uint8Array(e.data)):e.data).key;if(null!=i)switch(i){case o.MESSAGEKEY_LINK:o.onMessage_Link(t.dataLink,[].concat(e.ports));break;case o.MESSAGEKEY_ADD_REGISTRY:o.onMessage_AddRegistry(t.dataAddRegistry);break;case o.MESSAGEKEY_GOT_REGISTRY:o.onMessage_GotRegistry(t.dataGotRegistry);break;case o.MESSAGEKEY_EXECUTE:o.onMessage_Execute(t.dataExecute);break;case o.MESSAGEKEY_RESPOND:o.onMessage_Respond(t.dataResponse);break;case o.MESSAGEKEY_UNLINK:o.onMessage_Unlink(t.dataUnlink);break;case o.MESSAGEKEY_PROXY_CREATE_WORKER:o.onMessage_ProxyCreateWorker(t.dataProxyCreateWorker,[].concat(e.ports))}},this.updateRegistry();var i=[];if(h.forEach((function(e,r){for(var t=0,n=e;t<n.length;t++){var o=n[t];i.push(o)}})),this.postRegistry(e,new n.webworker_rpc.AddRegistryPacket({id:this.registryPackID,serviceName:this.name,executors:i})),"__MANAGER"===e)for(var a=this.linkTasks.length,s=0;s<a;s++){var c=this.linkTasks.pop(),u=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_REQUEST_LINK,dataRequestLink:new n.webworker_rpc.RequestLinkPacket({serviceName:this.name,workerName:c.workerName,workerUrl:c.workerUrl})});this.send(u,"__MANAGER",!1)}}},r.prototype.execute=function(e,r,t,i){var a=this;if(this.registry.has(e)){var s=this.registry.get(e).find((function(e){return e.context===t&&e.method===r}));if(null!=s){var c=s.params;if(c&&c.length>0){if(!i||0===i.length)return void console.error("webworker-rpc: method <"+r+"> execute error! ","param.length = 0");if(c.length>i.length)return void console.error("webworker-rpc: method <"+r+"> execute error! ","param not enough");for(var u=0;u<c.length;u++){var l=c[u],f=i[u];if(l.t!==f.data.t)return void console.error("webworker-rpc: method <"+r+"> execute error! ","param type not match, registry: <",n.webworker_rpc.ParamType[l.t],">; execute: <",n.webworker_rpc.ParamType[f.data.t],">")}}var p=this.resolverID++,d=new o;this.resolvers.set(p,d);for(var h=[],w=0,y=i;w<y.length;w++){var k=y[w];h.push(k.data)}return d.promise((function(){var o=new n.webworker_rpc.WebWorkerMessage({key:a.MESSAGEKEY_EXECUTE,dataExecute:new n.webworker_rpc.ExecutePacket({id:p,header:new n.webworker_rpc.Header({serviceName:a.name,remoteExecutor:new n.webworker_rpc.Executor({method:r,context:t,params:h})})})});a.send(o,e,!0)}))}console.error("webworker-rpc: method <"+r+"> not registed")}else console.error("webworker-rpc: worker <"+e+"> not registed")},r.prototype.respond=function(e,r,t,o){var i=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_RESPOND,dataResponse:new n.webworker_rpc.ResponsePacket({id:r,val:t.data,err:o})});this.send(i,e,!0)},r.prototype.updateRegistry=function(){if(!this.exported){this.exported=!0;for(var e=0,r=y;e<r.length;e++){var t=r[e];w.has(t)?this.exportObject(w.get(t),t):console.error("webworker-rpc: Export only decorate Emitter!")}for(var n=0,o=Array.from(k.keys());n<o.length;n++){var i=o[n],a=i.split("."),s=a[0];if(w.has(s))for(var c=0,u=k.get(i);c<u.length;c++){for(var l=u[c],f=w.get(s),p=1;p<a.length;p++){f=f[a[p]]}l in f?this.exportObject(f[l],i+"."+l,!1):console.error("webworker-rpc: "+l+" not in ",f)}else console.error("webworker-rpc: Export only decorate Emitter!")}}},r.prototype.postRegistry=function(e,r){if("__MANAGER"!==e){var t=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_ADD_REGISTRY,dataAddRegistry:r});this.send(t,e,!0)}},r.prototype.onMessage_Link=function(e,r){for(var t=e.workers,n=0;n<r.length;n++){var o=r[n],i=t[n];this.addChannel(i,o)}},r.prototype.onMessage_AddRegistry=function(e){var r=e.id,t=e.serviceName,o=e.executors;this.registry.has(t)||this.registry.set(t,[]);var i=this.registry.get(t).concat(o);this.registry.set(t,i),this.addRegistryProperty(e);var a=new n.webworker_rpc.WebWorkerMessage({key:this.MESSAGEKEY_GOT_REGISTRY,dataGotRegistry:new n.webworker_rpc.GotRegistryPacket({id:r,serviceName:this.name})});if(this.send(a,t,!0),this.updateLinkState(t),g.has(t)){for(var s=0,c=g.get(t);s<c.length;s++){var u=c[s];this.remote[t][u.context].on(u.event,u.executor,this.name)}g.delete(t)}},r.prototype.onMessage_GotRegistry=function(e){var r=e.id,t=e.serviceName;this.linkListeners.has(t)&&(this.linkListeners.get(t).setPortReady(t)&&this.linkListeners.delete(t));this.syncRegistryListeners.has(r)&&this.syncRegistryListeners.get(r).workerGotRegistry(t)},r.prototype.onMessage_Execute=function(e){var r=this,t=e.id,n=e.header,o=n.serviceName,a=n.remoteExecutor,s=[];if(void 0!==a.params&&null!==a.params)for(var c=0,u=a.params;c<u.length;c++){var l=u[c],f=new i(l).getValue();s.push(f)}var p=this.executeFunctionByName(a.method,a.context,s);p instanceof Promise?p.then((function(e){r.handlerExcuteResult(o,t,e)})):this.handlerExcuteResult(o,t,p)},r.prototype.onMessage_Respond=function(e){var r=e.id,t=e.val;if(this.resolvers.has(r)){var n=this.resolvers.get(r);if(this.resolvers.delete(r),e.hasOwnProperty("err")&&void 0!==e.err&&null!==e.err)return console.error("webworker-rpc: get error response: ",e.err),void n.reject(e.err);null==t?n.resolve():n.resolve(new i(t).getValue())}else console.error("webworker-rpc: response.id undefined: ",r)},r.prototype.onMessage_Unlink=function(e){var r=e.serviceName;this.channels.has(r)&&this.channels.delete(r),this.registry.has(r)&&this.registry.delete(r),void 0!==this.remote&&null!==this.remote&&r in this.remote&&delete this.remote[r],this.onWorkerUnlinked(r)},r.prototype.onMessage_ProxyCreateWorker=function(e,r){var t=e.workerName,n=e.workerUrl,o=e.msg;if("undefined"!=typeof Worker){var i=n,a=new Worker(i,{name:t});console.log("webworker-rpc: "+this.name+" create worker: ",i,t),this.send(o,a,!0,[].concat(r))}else console.error("webworker-rpc: Worker undefined! can not create worker")},r.prototype.exportObject=function(e,r,t){void 0===t&&(t=!0);var o=[];for(var i in e)if(!x.includes(i)||P.includes(i)){var a=e[i];if("function"==typeof a){var s=new n.webworker_rpc.Executor({method:i,context:r});v(s)&&o.push(s)}else if(t&&a instanceof Object){var c=r.concat(".",i);o=o.concat(this.exportObject(a,c))}}var u=r.split(".");if("constructor"!==u[u.length-1]){var l=e.constructor,f=this.exportObject(l,r+".constructor",t);o=o.concat(f)}return o},r.prototype.executeFunctionByName=function(e,r,t){var n=this.getContext(r);return null==n?(console.warn("webworker-rpc: excute function <"+e+"> error, no context <"+r+"> exist"),null):n[e].apply(n,t)},r.prototype.getContext=function(e){var r=e.split(".");if(!w.has(r[0]))return console.error("webworker-rpc: no context exist: ",r[0]),null;for(var t=w.get(r[0]),n=1;n<r.length;n++){var o=r[n];if(!(o in t))return console.warn("webworker-rpc: "+o+" is undefined in ",t),null;t=t[o]}return t},r.prototype.addRegistryProperty=function(e){var r=this;void 0!==this.remote&&null!==this.remote||(this.remote={});var t=e.serviceName,n=e.executors,o={};t in this.remote?o=this.remote[t]:S(this.remote,t,o);for(var a=function(e){for(var n=e.context.split("."),a=o,s=0,c=n;s<c.length;s++){var u=c[s];"constructor"!==u&&(u in a||S(a,u,{}),a=a[u])}S(a,e.method,(function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=[];if(null!=n)for(var s=0,c=n;s<c.length;s++){var u=c[s];a.push(i.createByValue(u))}return r.execute(t,e.method,e.context,a)}))},s=0,c=n;s<c.length;s++){a(c[s])}},r.prototype.getManagerWorkerURL=function(){var e=l.toString(),r=new Blob(["\n            self.addEventListener('message', function(e) {\n                (("+e+")(e));\n            });\n        "],{type:"text/javascript"});return URL.createObjectURL(r)},r.prototype.updateLinkState=function(e){this.linkListeners.has(e)&&(this.linkListeners.get(e).setPortReady(this.name)&&this.linkListeners.delete(e))},r.prototype.handlerExcuteResult=function(e,r,t){this.respond(e,r,i.createByValue(t))},r.useSharedArrayBuffer=!1,p([O(),d("design:type",Function),d("design:paramtypes",[String,String,Boolean]),d("design:returntype",R)],r.prototype,"attach",null),p([m(),d("design:type",Function),d("design:paramtypes",[]),d("design:returntype",void 0)],r.prototype,"destroy",null),r}(E),R=function(){function e(e,r){this.port1="",this.port2="",this.port1Ready=!1,this.port2Ready=!1,this.port1=e,this.port2=r}return e.prototype.onceReady=function(e){this.readyFunc=e},e.prototype.setPortReady=function(e){return(this.port1===e||this.port2===e)&&(this.port1Ready||(this.port1Ready=this.port1===e),this.port2Ready||(this.port2Ready=this.port2===e),!(!this.port1Ready||!this.port2Ready)&&(this.readyFunc&&(this.readyFunc(),this.readyFunc=null),!0))},e}(),j=function(){function e(e,r){this.id=e,this.workersState=new Map;for(var t=0,n=r;t<n.length;t++){var o=n[t];"__MANAGER"!==o&&this.workersState.set(o,!1)}}return e.prototype.onceReady=function(e){this.readyFunc=e},e.prototype.workerGotRegistry=function(e){if(this.workersState.has(e)){this.workersState.set(e,!0);for(var r=!0,t=0,n=Array.from(this.workersState.keys());t<n.length;t++){var o=n[t];if(!this.workersState.get(o)){r=!1;break}}r&&this.readyFunc&&(this.readyFunc(),this.readyFunc=null)}},e}();function S(e,r,t){return r in e?(console.warn("webworker-rpc: key exist, add property failed!",e,r),e):(e[r]=t,e)}}])}));